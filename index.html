<!DOCTYPE html >
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="chrome=1"/>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>g-code simulator</title>
    <script src="http://www.x3dom.org/download/dev/x3dom.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <link rel="stylesheet" href="http://www.x3dom.org/download/dev/x3dom.css">
    <script src="parser.js"></script>
    <style>
        X3D, x3d {
            float: right;
            width: 50%;
            height: 400px;
        }

        .editBlock {
            position: relative;
            float: left;
            width: 49%;
            height: 400px;
            padding: 1px;
            margin: 0;
            text-align: right;
        }

        .editBlock textarea {
            width: 100%;
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
            height: 350px;
        }
    </style>
</head>
<body>

<h1>G-Code Q'n'dirty toolpath simulator</h1>

<p>
    Paste your g-code in the left window and see the 3D preview of your toolpath on the right.<br>
    The right pane is interactive, drag it to change the point of view (<a
        href="http://x3dom.org/docs/dev/navigation.html#interactive-camera-movement">full view doc</a>).
</p>

<p>
    <a href="https://github.com/nraynaud/webgcode/tree/gh-pages">https://github.com/nraynaud/webgcode/tree/gh-pages</a>
</p>

<x3d id="x3d" xmlns="http://www.x3dom.org/x3dom" showStat="false" showLog="false" x="0px" y="0px">
    <Scene id="scene" DEF='scene'>
        <Shape id="xaxis">
            <Appearance>
                <Material emissiveColor='1 0 0'/>
            </Appearance>
            <IndexedLineSet id="lineSet" coordIndex="0 1 -1">
                <Coordinate id="coordinates" point="0.0 0.0 0.0, 10.0 0.0 0.0"/>
            </IndexedLineSet>
        </Shape>
        <transform translation='11 0 0'>
            <Shape>
                <Appearance>
                    <Material emissiveColor='1 0 0'/>
                </Appearance>
                <text string='X' style="BOLD"></text>
            </Shape>
        </transform>
        <Shape id="yaxis">
            <Appearance>
                <Material emissiveColor='0 1 0'/>
            </Appearance>
            <IndexedLineSet id="lineSet" coordIndex="0 1 -1">
                <Coordinate id="coordinates" point="0.0 0.0 0.0, 0.0 10.0 0.0"/>
            </IndexedLineSet>
        </Shape>
        <transform translation='0 11 0'>
            <Shape>
                <Appearance>
                    <Material emissiveColor='0 1 0'/>
                </Appearance>
                <text string='Y' style="BOLD"></text>
            </Shape>
        </transform>
        <Shape id="zaxis">
            <Appearance>
                <Material emissiveColor='0 0 1'/>
            </Appearance>
            <IndexedLineSet id="lineSet" coordIndex="0 1 -1">
                <Coordinate id="coordinates" point="0.0 0.0 0.0, 0.0 0.0 10.0"/>
            </IndexedLineSet>
        </Shape>
        <transform translation='0 0 11'>
            <Shape>
                <Appearance>
                    <Material emissiveColor='0 0 1'/>
                </Appearance>
                <text string='Z' style="BOLD"></text>
            </Shape>
        </transform>
    </Scene>
</x3d>
<div class="editBlock">
    <textarea id="codebox">
        G0 Y10 Z-5
        G1 Z-10
        G1 Y20
        G02 X10 Y30 R10
        G1 X30
        G2 X40 Y20 R10
        G1 Y10
        G2 X30 Y0 R10
        G1 X10
        G2 X0 Y10 Z-15 R10 (yeah spiral !)
        G3 X-10 Y20 R-10 (yeah, long arc !)
        G3 X0 Y10 I10 (center)
        G91 (incremental position)
        G1 X10 Z10
        G3 Y10 R5 Z3 (circle in incremental)
        Y10 R5 Z3 (again, testing modal state)
    </textarea>
    <button onclick="evaluateCode();">Simulate</button>
</div>
<script>
    x3dom.runtime.ready = (function () {
        evaluateCode();
        $('#x3d')[0].runtime.showAll();
    });</script>
</body>
</html>

